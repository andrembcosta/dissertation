\section{Background}

%% Motivation for fluid-driven fracture

    % Shale gas extraction

    % EGS

    % Carbon storage

%% Literature review on traditional approaches (including 3D)

    % Basics of HF modeling

    Any mathematical model that tries to represent the hydraulic fracturing phenomena has to account for at least three different processes. The deformation of the rock, the fluid flow and the fracture propagation. \cite{adachi2007computer}. These three processes are strongly coupled, which makes the derivation of analytical solutions very complicated, and only possible where the fracture has a predefined shape. Some examples of that are the PKN model \cite{perkins1961widths, sneddon1946opening, nordgren1972propagation} and the KGD model \cite{zheltov19553, geertsma1969rapid}, developed in the early days of the hydraulic fracturing technology. Although limited by restrictive assumptions, they were extremely useful at that time, providing engineers with good estimations of treatment parameters.

    % Detournay's analytical methods

    The topic of analytical approaches is still an ongoing area of research with significant progress being made in the past decades, specifically in understanding propagation regimes, near-tip processes, and scaling laws. Extensive research has yielded valuable insights. For instance, near-tip solutions for zero-toughness, impermeable fractures were derived using asymptotic theory in \cite{desroches1994crack}, and the analysis was extended to leak-off dominated cases in \cite{lenoach1995crack}. Subsequent studies have incorporated additional factors, such as finite toughness and fluid-lag \cite{detournay2002asymptotic, detournay2003near, garagash2000tip}. Moreover, similar techniques have been applied to identify the dimensionless groups that govern the key characteristics of the solutions, enabling the categorization of main regimes (leak-off, toughness, or viscosity dominated) within the parameter space. This parameter space includes rock properties like elastic moduli, toughness, and leak-off coefficient, as well as treatment characteristics such as fluid viscosity and injection rate \cite{detournay2004propagation, adachi2002self, carbonell1999comparison, savitski2002propagation, garagash2005plane}.

     %%%%%%%%%%%%%%%%%%%%%%ADACHI PAPER
    % In recent years, there has been a return to fundamental research, with significant effort being devoted to understanding the different regimes of propagation in hydraulic fracturing. The objective of this research has been to gain insight into the properties of the classical hydraulic fracture models rather than to develop new models to deal with the complex and challenging new environments in which hydraulic fractures are being developed. This work was developed on two fronts. First, an exhaustive analysis of the near-tip processes (using methods based on asymptotic theory) was undertaken, which has significantly extended the pioneering results of [40] for the zero-toughness, impermeable case; and of [41] for the zero-toughness, leak-off dominated case. This ongoing effort has accomplished not only the inclusion of toughness and fluid lag, but also the development of all the pertinent intermediate asymptotic regimes [42–44]. The second front includes the analysis of the dominant dimensionless groups that control the hydraulic fracturing process [45,46]. This work has shown that hydraulic fractures can be categorized within a parametric space, whose extremes are controlled by leak-off, toughness, or viscosity dominated processes. In general, a hydraulic fracture evolves with time within this parametric space, following trajectories that are determined by the rock properties (elastic moduli, toughness, leak-off coefficient), fluid viscosity, and injection rate. Within this framework, semi-analytical and numerical solutions have been developed for simple geometries (KGD and penny-shaped) for different asymptotic regimes, such as zero toughness impermeable [47–49]; small toughness impermeable [50]; finite toughness impermeable [51,26]; large toughness impermeable [52,49]; zero toughness permeable [53] regime; and finite toughness permeable [54] regime solutions. These solutions have not only yielded an understanding of the evolution of hydraulic fractures in and between different propagation regimes, but have also provided useful benchmarks for numerical simulators. Another important consequence of this research work is that the newly developed scaling laws can be used to define the range of parameters required to properly model the growth of a hydraulic fracture at the field or laboratory scale, or at least to properly interpret and extrapolate experimental data. For example, in most field-scale treatments, the dominant factor that controls hydraulic fracture growth is viscosity, and not toughness (the latter quantity has been historically used to assign fracture growth control in hydraulic fracturing simulators). However, in laboratory tests, where block sizes of 1 cubic foot are typical, toughness is the controlling mechanism, even when highly viscous fluids are injected. Hence, direct application of experimental results to field scale may lead to misleading conclusions. Recent experimental results [55–57] have provided physical evidence of the validity of these similarity solutions. The scaling law methodology was crucial in identifying the appropriate ranges of parameters in order to design the experiments to capture these different physical solutions.
    %%%%%%%%%%%%%%%%%%%%%%

    Although these analytical methods provide valuable insight into the physics and allow for useful back of the envelope calculations, they can not be used to simulate most of the practical fracking treatments due to their restrictive assumptions regarding fracture geometry and homogenous material properties. They also are not able to capture other important phenomena that affect hydraulic fracturing, such as the presence of confining (\textit{in situ}) stresses, pre-existing (natural) fractures, proppant transport and etc.
    All these issues have been demonstrated by experiments to affect the fracture propagation and therefore, motivated the development of more general computational approaches that aim to obtain approximations to the solution of the general fluid-driven fracture models.

    These approaches range from production-level reservoir modeling tools such as ResFrac\cite{mcclure2017three, mcclure2018resfrac}, Xsite\cite{itasca}, Kinetix\cite{kinetix,kinetixforpetrel} (check \cite{chen2021review} for an extensive list) to open-source alternatives, such as GEOS\cite{settgast2012simulation, settgast2014simulation, settgast2017fully}, PyFrac\cite{zia2020pyfrac} and others. Many of the models and associated codes assume fracture networks that remain planar, but in recent years strides have been made towards modeling cracks that evolve in arbitrary ways in response to fluid-driven loads. Some works in this direction include (i) Gupta and Duarte \cite{gupta2014simulation, gupta2018coupled} which used a higher-order generalized finite element method (GFEM) to discretize the fracture surface and compute accurate stress intensity factors(SIFs); (ii) Salimzadeh et al. [271, 272, 273] and Paluszny et al. [238] which used adaptive remeshing and a pure FEM based approach, in combination with the displacement correlation method to calculate the SIFs even in the presence of multiple interacting fractures and (iii) Tang et al. (2019) and Li et al. (2020a) where the boundary element method is combined with the displacement discontinuity approach to propagate fractures which are loosely coupled to the mechanical problem using EDFM\cite{hajibeygi2011hierarchical}. However, in all these approaches, the computation of crack front advancements still relies on phenomenological relations between the computed SIFs and some type of crack front velocity. They also have some limitations when dealing with merging cracks (for example, when a hydraulic fracture approaches a natural fracture), as the formulations do not account for the possibility of a propagating crack to arrest in these cases.
    
    High-resolution models for complex fracture evolution generally fall into two categories: sharp interface models that explicitly model the fracture surface, and diffuse crack approaches that effectively smear the geometry over the underlying grid or mesh.  Techniques that represent the crack as a sharp interface can be advantageous when the fracture configuration is relatively simple, but representing complex geometric evolution can be challenging  \cite{gupta2014simulation, gupta2018coupled, shauer2022three}.
    
    Some of these challenges tend to be alleviated with the use of diffuse crack models, such as the phase-field model for fracture \cite{francfort1998revisiting, bourdin2000numerical, karma2001phase}. These offer more flexibility for representing complex fracture evolution, and, in many times, have propagation fully governed by energetics principles, being, in some sense, a generalization of Griffiths' law \cite{griffith1921vi}. On the other hand, they introduce other challenges such as the lack of a well-defined fracture surface and increased computational expense\cite{heider2021review}.  
%% Phase-field method for hydraulic fracture

    % A few paragraphs about the phase-field method and its advantages

    % Bourdin and Wheeler's early work

    % Other derived works coupling poromechanics

    % Thorough comparision with tables and etc

    % Some limitations and possible improvements

    % Among these diffuse methods, the phase-field model for fracture \cite{francfort1998revisiting, bourdin2000numerical, karma2001phase} has emerged as a promising approach for constructing robust simulations of complex crack evolution. The method has shown considerable success for simulating fracture evolution in quasi-brittle materials, and there have been several recent efforts to extend the approach to hydraulic fracturing. In what follows, we review some prior works of particular relevance to the current manuscript.  For additional references in this topic, we refer the reader to the recent review by Heider \cite{heider2021review}.

    The first attempts towards a phase-field model for hydraulic fracture began with extensions of the traditional phase-field model to pressurized cracks, as in Bourdin et al. \cite{bourdin2012variational} and Wheeler et al. \cite{wheeler2014augmented}. Subsequently, fluid flow in the fractures, and also poromechanics were considered. Miehe et al. \cite{miehe2015minimization, miehe2016phase} developed a thermodynamically consistent framework, from minimization principles, to couple poromechanics, fluid-flow and phase-field fracture. The flow problem was modeled via the Darcy's equation, containing a permeability coefficient that used the phase-field variable and the crack opening to mimic the cubic relationship from the lubrication theory in the crack region. Mikelic et al. \cite{mikelic2015phase1, mikelic2015phase2} developed a model that separated the domain into fracture and reservoir, by using the phase-field variable as an indicator function. They also considered the flow inside the fracture as a Darcy flow, but their model treated the fracture as a three-dimensional entity, which led to a different permeability tensor compared to \cite{miehe2015minimization, miehe2016phase}.  Yet another approach concerns the work of Wilson and Landis \cite{wilson2016phase}, who proposed a model that included fluid velocities as primary variables. This allowed for a more detailed description of the flow within the fracture, which was modeled by a Brinkman-type equation \cite{brinkman1949calculation}. The phase-field parameter acted as an indicator of the flow regime, between Darcy flow (away from cracks) and Stokes flow (inside cracks).  Finally, the recent work of Chukwudozie et al.\ \cite{chukwudozie2019variational} presented a different model, wherein the lubrication theory equations were included in the weak form by means of a $\Gamma$-convergent regularization. These various formulations exhibit real differences in terms of their structure and form when it comes to how the pressure loads are incorporated and fracture apertures computed and very few attempts towards a comparison of them have been made.

    The use of a phase-field to represent a fracture network in a diffuse manner certainly facilitates the representation of complex geometric evolution, including crack branching and merging. However, it also requires the use of meshes or grids that are capable of resolving the regularization length, making these approaches computationally expensive. One approach to improving the efficiency of the method is the use of adaptive mesh refinement, such as in \cite{heister2015primal, lee2017iterative, Wick-adaptive-2020,Gupta-adaptive-2022}. In the specific case of hydraulic fracturing, another challenge concerns the crack opening or aperture, a field that is tightly coupled with the fluid pressure within fractures. In a phase-field setting, due to the lack of an explicit crack surface, extracting the aperture or accounting for its effects requires additional considerations.  All of the aforementioned  works present some way to account for the aperture within a diffuse setting, but the robustness of these approaches remains unclear \cite{lecampion2018numerical}. For a review of the most frequently used methods to calculate the crack aperture from phase-field simulations, see the recent work of Yoshioka et al.\ \cite{yoshioka2020crack}.

%% Hybrid approaches

    Outside of the context of hydraulic fracturing, some researchers in the phase-field community have developed ``hybrid" approaches, wherein the phase-field formulation was combined with a sharp crack representation. The motivation for these approaches varies, from ``cutting" the mesh to remove artificial traction transmission and circumvent element distortion \cite{geelen2018optimization} to reducing the overall computational cost \cite{giovanardi2017hybrid, muixi2021combined}. In the work of Giovanardi et al.\ \cite{giovanardi2017hybrid}, phase-field subproblems in the vicinity of  crack tips were used to propagate a global, discrete crack. The eXtended Finite Element Method (XFEM)\cite{moes1999finite} was used to place fracture discontinuities in the displacement field within the background global mesh. More recently, Muixi et al.\ \cite{muixi2021combined} created an approach that uses the phase-field method only at the crack tips, and XFEM in the rest of the domain. In contrast to \cite{giovanardi2017hybrid}, there is no overlap of the representations in crack tip areas.

    The success of these hybrid approaches for purely mechanical cases opens the door for their extension to hydraulic fracturing.  Such approaches are appealing because in principle they can circumvent the need for a complicated reconstruction of the crack opening from the phase-field.  This area is relatively unexplored, although there have been some recent efforts that are similar in spirit, such as the recent work of Sun et al.\ \cite{sun2020hybrid}.  They developed a Finite Element-Meshfree method to represent the crack surfaces in a discrete fashion. The computed displacement field was used to obtain a driving force which was employed within a phase-field evolution equation near the crack tips. This approach eliminated the need for the reconstruction of crack openings from the diffuse crack representation, but it also largely decoupled the phase field from the equations governing the force balance near the crack tips. 

    % Giovannardi including newest work from Formmagia on HF

    % Rudy's continuous discontinuous

    % Muixí's work

    % Recent work from chinese group

%% Commercial codes and intro on GEOSX

    % Check review paper from Bin Chen

    % Is there any review on HPC, GPU computing ?

%% INTRO MR PAPER


%%INTRO PRESSURE PAPER
% One of these tools is the phase-field method for fracture \cite{bourdin2000numerical}. Initially developed for traction-free cracks, the method has since been extended to account for pressure loading on the surfaces of cracks, as in \cite{bourdin2012variational, wheeler2014augmented, mikelic2015quasi, peco2017influence, jiang2022phase}.  These various formulations exhibit real differences in terms of their structure and form when it comes to how the pressure loads are incorporated.  
% The objective of this work is to examine the impact of the various choices, and to compare them to 
% a relatively new formulation for pressurized crack surfaces in a phase-field for fracture context \cite{hu2021variationalthesis}.  
% The main contributions of this work are: (a) to show that established formulations for pressure-driven fracture in the phase-field
% context have limitations when cohesive processes are involved; (b) to demonstrate that the new formulation, derived from variational principles, can address these limitations and be easily combined with phase-field models of cohesive fracture; and (c) to illustrate the advantages and disadvantages of the various models in terms of accuracy in obtaining various quantities of interest.  

% Phase-field methods for fracture regularize sharp crack representations through the use of a scalar phase or damage field whose evolution is governed by minimization principles.  
% Such methods first appeared, in different forms, in the works of Bourdin et al. \cite{bourdin2000numerical} and Karma et al. \cite{karma2001phase}. The model introduced in Bourdin et al. \cite{bourdin2000numerical} was obtained by a regularization of the variational formulation of fracture developed in Francfort and Marigo \cite{francfort1998revisiting}, using ideas from Ambrosio and Tortorelli \cite{ambrosio1990approximation}. It has been widely adopted in the mechanics community and extended for use in a variety of fracture mechanics problems,  such as ductile failure \cite{alessi2014gradient, ambati2015phase, miehe2016phase, borden2016phase, hu2021variationalpaper}, hydraulic fracture \cite{wilson2016phase, chukwudozie2019variational, mikelic2015phase1, santillan2018phase, miehe2016phase}, dessication problems \cite{maurini2013crack, heider2020phase, cajuhi2018phase, hu2020frictionless}, dynamic fracture\cite{bourdin2011time, borden2012phase, hofacker2013phase, schluter2014phase, li2016gradient, kamensky2018hyperbolic, moutsanidis2018hyperbolic}, fracture in biomaterials \cite{wu2020fracture, raina2016phase, nagaraja2021phase, gultekin2016phase, gultekin2018numerical} and many more. Some recent reviews can be found in \cite{ambati2015review, wu2020phase, francfort2021variational}.

% With regard to the use of the phase-field method for hydraulic fracture problems, one challenge concerns how best to incorporate surface loads that result from pressures on crack faces that are diffuse.  One approach is to regularize the resulting surface tractions with an approach that is very similar to how the crack surface energy is regularized. Early work along these lines focused on crack surfaces loaded by constant pressures, as in Bourdin et al. \cite{bourdin2012variational} and Wheeler et al.\cite{wheeler2014augmented}. Since these early developments, these models have been used extensively for the study of pressurized fractures, for example in \cite{tanne2022loss, zulian2021large, yoshioka2019comparative, yoshioka2020crack}.
% They were also extended and modified to account for fluid flow inside the fractures and poroelasticity in the surrounding medium \cite{miehe2016phase, mikelic2015phase1, chukwudozie2019variational, wilson2016phase, santillan2018phase, heider2017phase, li2022hydro}. The reader is referred to the recent review by  Heider \cite{heider2021review} for additional works on phase-field methods for hydraulic fracture.  The various models all employ some form of ``indicator function" that assists in the regularization of the surface load itself.  Despite several different indicator functions being proposed, the implication of the particular choice of indicator on the accuracy of the models has yet to be thoroughly examined.  

% In this manuscript, a new formulation for the study of pressurized fractures, first proposed in the thesis of Hu~\cite{hu2021variationalthesis} is also examined. In particular, it is studied in combination with a cohesive version of the phase-field for fracture method, which was proposed in the recent works of \cite{lorentz2011convergence, geelen2019phase, wu2017unified}.  This facilitates the study of pressurized fracture in quasi-brittle materials and reduces the sensitivity of the effective strength to the regularization length. To ensure that the cohesive fracture behavior is preserved, the implicit traction-separation law is evaluated for a simple one-dimensional problem and shown to be insensitive to the applied pressure with the new formulation. 
% Fracture initiation and propagation examples are also examined to highlight advantages and limitations of the model. 

